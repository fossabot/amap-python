# Generate figures

N.B. A command line tool has not yet been developed. For now, figures can only 
be generated by using the ``--figures`` flag in `cellfinder_run`. 

By default, if you use the `--figures` flag, a number of files will be 
generated. Until custom figures can be generated in cellfinder, these files 
are generated to allow you to more easily make figures in e.g. 
[FIJI](https://fiji.sc). More details can be found [here](tools/figures.md).

The idea is that these images can be combined to generate more custom figures.
These images are all saved in the same coordinate space as the downsampled 
raw data saved into `output_directory/registration`. 
Currently three files will be generated by default.

* **heatmap.nii** - This is a 3D histogram, showing cell densities throughout 
the brain. Likely to be more useful than visualising cell positions for dense 
areas. By default, this is smoothed, and masked (so that the smoothing doesn't
"bleed" outside of the brain)
* **glass_brain.nii** This is a binary image, just showing the brain surface. 
Plotting this in 3D along with **heatmap.nii** gives a nice sense of 
cell density throughout the brain. [ClearVolume](https://imagej.net/ClearVolume)
 works well for this.
* **boundaries.nii** Another binary image, but showing the divisions between 
each region in the atlas. More useful for smaller, 3D figures to delineate 
region boundaries. Also useful to assess registration by overlaying on the raw,
downsampled data. 

There are not yet many options, but the current options are here:

* `--no-heatmap` Don't generate a heatmap of cell locations
* `--heatmap-bin` Heatmap bin size (mm of each edge of histogram cube)
* `--heatmap-smoothing` Gaussian smoothing sigma, in mm.
* `--no-outlines` Don't generate outlines of segmentation regions (for overlay)
* `--no-mask-figs` Don't mask the figures (removing any areas outside the 
brain, from e.g. smoothing)